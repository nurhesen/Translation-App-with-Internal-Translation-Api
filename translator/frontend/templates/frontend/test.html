<!DOCTYPE html>
<html>
<body>

<p>This example uses the HTML DOM to assign an "onsubmit" event to a form element.</p>

<p>When you submit the form, a function is triggered which alerts some text.</p>

<form id="myForm" action="/action_page.php">
  <input id="body" type="text" name="body">
  <input id="image" type="file" name="image">

  <input type="submit" value="Submit">
</form>




<form action="/api/testpost/" method="POST" enctype="multipart/form-data" class="form-horizontal" novalidate="">
  <fieldset>
    

<div class="form-group ">

<label class="col-sm-2 control-label ">
Body
</label>


<div class="col-sm-10">
<textarea name="body" class="form-control"></textarea>




</div>
</div>




<div class="form-group ">

<label class="col-sm-2 control-label ">
Image
</label>


<div class="col-sm-10">
<input name="image" type="file" value="">



</div>
</div>




    <div class="form-actions">
      <button class="btn btn-primary js-tooltip" title="" data-original-title="Make a POST request on the Text Post List resource">POST</button>
    </div>
  </fieldset>
</form>








<script>
document.getElementById("myForm").onsubmit = function(e) {
  
  e.preventDefault();

  let body=document.getElementById("body").value
  let image = document.getElementById("image").files





  PostShare(body, image)




};

async function myFunction() {

  alert("The form was submitted");
}






async function PostShare (body, image){

    const formData = new FormData();



    formData.append('body', body);

    formData.append('image', image);
    
    
    
    const response = await (fetch('http://127.0.0.1:8000/api/post/', {
      method: 'POST',
      mode: 'same-origin',
      credentials: 'include',

      body: formData

    }).then((response) => {
        if(response.status===201){
            console.log(response)

            
            return response.json()

        }
    }))
}

















</script>

</body>
</html>
